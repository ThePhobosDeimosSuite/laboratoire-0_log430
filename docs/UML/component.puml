@startuml component
skinparam componentStyle rectangle
skinparam defaultTextAlignment center

package "API Gateway" {
  [Kong]
}

package "Monitoring" {
  [Prometheus]
  [Grafana]
}


package "Microservices" {
  component Product
  component Sales
  component Stocks
  component Account
  component ShoppingCart
  component OnlineSalesOrchestrator
  component EventStore
  component Package as p
  component Email
}

database "ProductDB" as dbProduct
database "SalesDB" as dbSales
database "StocksDB" as dbStocks
database "AccountDB" as dbAccount
database "CartDB" as dbCart
database "EventDB" as dbEvent
database "Redis" as redis


Kong --> Product
Kong --> Sales
Kong --> Stocks
Kong --> Account
Kong --> OnlineSalesOrchestrator
Kong --> EventStore
Kong --> p

p --> Email
p --> EventStore

Product --> dbProduct
Sales --> dbSales
Stocks --> dbStocks
Account --> dbAccount
ShoppingCart --> dbCart
EventStore --> dbEvent
EventStore --> redis


OnlineSalesOrchestrator --> Product
OnlineSalesOrchestrator --> Sales
OnlineSalesOrchestrator --> Stocks
OnlineSalesOrchestrator --> ShoppingCart

Prometheus --> Product
Prometheus --> Sales
Prometheus --> Stocks
Prometheus --> Account
Prometheus --> ShoppingCart
Prometheus --> p
Prometheus --> EventStore

Grafana --> Prometheus

@enduml
